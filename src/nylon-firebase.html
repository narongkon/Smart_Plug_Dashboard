<script src="../bower_components/firebase/firebase.js"></script>
<script src="../bower_components/firebase/firebase-auth.js"></script>
<script>
    class nylonFirebase {
        constructor() {
            firebase.initializeApp(
                {
                    apiKey: "AIzaSyDOgznhJOKY0bBLkPX9GzQ-MuIeaf5Ybm0",
                    authDomain: "smart-city-1510497172312.firebaseapp.com",
                    databaseURL: "https://smart-city-1510497172312.firebaseio.com",
                    projectId: "smart-city-1510497172312",
                    storageBucket: "smart-city-1510497172312.appspot.com",
                    messagingSenderId: "1066409678928"
                }
            );
        }
        // checkUserWithFirebase() {
        //     var store = localStorage.getItem('firebase:authUser:AIzaSyCteLrUY1ZLtkyrjDixKxOzjf4aX4aClEM:[DEFAULT]');
        //     var obj = JSON.parse(store);
        //     console.log(obj)
        //     if (obj) {
        //         return true;
        //     }
        //     else return false;
        //     // if(obj){
        //     //     if(obj.uid)
        //     //         Nylon.dispatch('authLoginWithGoogle',obj.uid);
        //     // }
        // }

        loginWithFacebook() {
            var provider = new firebase.auth.FacebookAuthProvider();
            firebase.auth().signInWithPopup(provider).then(function (result) {
                // This gives you a Facebook Access Token. You can use it to access the Facebook API.
                var token = result.credential.accessToken;
                // The signed-in user info.
                var user = result.user;
                // ...
            }).catch(function (error) {
                // Handle Errors here.
                var errorCode = error.code;
                var errorMessage = error.message;
                // The email of the user's account used.
                var email = error.email;
                // The firebase.auth.AuthCredential type that was used.
                var credential = error.credential;
                // ...
            });
        }
        loginWithGoogle() {
            var provider = new firebase.auth.GoogleAuthProvider();
            firebase.auth().signInWithPopup(provider)
                .then((res) => {
                    console.log(err);
                    // var value = res.user.providerData[0]
                    // var data = {
                    //     email: value.email,
                    //     name: value.displayName,
                    //     photoURL: value.photoURL,
                    //     providerId: value.providerId,
                    //     uid: res.user.uid,
                    //     type: 'student'
                    // }
                    // Nylon.dispatch('authLoginWithGoogle', res.user.uid, data);
                })
                .catch((err) => {
                    console.log(err)
                })
        }

        logout() {
            // firebase.auth().signOut()
            //     .then(function (res) {

            //     }.bind(this))
            //     .catch(function (error) {
            //         console.log(error)
            //     })
            firebase.auth().signOut().then(function () {
                // Sign-out successful.
            }).catch(function (error) {
                // An error happened.
            });
        }
    }

    Nylon.firebase = new nylonFirebase()

</script>